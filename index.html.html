
<!DOCTYPE html>
<html>
<head>
  <title>Liability Waiver & Indemnity Agreement</title>
  <script src="https://cdn.jsdelivr.net/npm/signature_pad@4.0.0/dist/signature_pad.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    canvas { border: 1px solid #000; width: 100%; height: 200px; }
    .form-section { margin-bottom: 20px; }
    label { display: block; margin-top: 10px; }
    input, select { width: 100%; padding: 5px; margin-top: 5px; }
    button { margin-top: 10px; padding: 10px 20px; }
  </style>
</head>
<body>
  <h2>Liability Waiver & Indemnity Agreement</h2>
  <p><strong>IMPORTANT NOTICE:</strong><br>
  Horse riding and related equestrian activities involve inherent risks. By signing this agreement, you acknowledge and accept these risks on behalf of yourself and/or your minor child. You also waive certain legal rights. Please read carefully.</p>

  <form id="waiverForm">
    <div class="form-section">
      <label>Participant Name</label>
      <input type="text" name="participant_name" required>

      <label>Date of Birth</label>
      <input type="date" name="dob" required>

      <label>Parent/Guardian’s Name (if under 18)</label>
      <input type="text" name="guardian_name">

      <label>Residential Address</label>
      <input type="text" name="address" required>

      <label>City</label>
      <input type="text" name="city" required>

      <label>State / Province</label>
      <input type="text" name="state" required>

      <label>Postal / Zip Code</label>
      <input type="text" name="zip" required>

      <label>Emergency Contact Name</label>
      <input type="text" name="emergency_name" required>

      <label>Emergency Contact Phone Number</label>
      <input type="tel" name="emergency_phone" required>

      <label>Photo & Media Consent</label>
      <select name="media_consent" required>
        <option value="">--Please Select--</option>
        <option value="Yes">Yes</option>
        <option value="No">No</option>
      </select>
    </div>

    <div class="form-section">
      <label>Participant’s Signature (if older than 18)</label>
      <canvas id="participantSignature"></canvas>
      <button type="button" onclick="clearSignature(participantPad)">Clear Signature</button>
      <label>Date</label>
      <input type="date" name="participant_date">
    </div>

    <div class="form-section">
      <label>Parent/Guardian’s Signature (if under 18)</label>
      <canvas id="guardianSignature"></canvas>
      <button type="button" onclick="clearSignature(guardianPad)">Clear Signature</button>
      <label>Date</label>
      <input type="date" name="guardian_date">
    </div>

    <button type="submit">Submit Waiver</button>
    <button type="button" onclick="printWaiver()">Print Waiver</button>
  </form>

  <script>
    const participantPad = new SignaturePad(document.getElementById('participantSignature'));
    const guardianPad = new SignaturePad(document.getElementById('guardianSignature'));

    function clearSignature(pad) {
      pad.clear();
    }

    document.getElementById('waiverForm').addEventListener('submit', function(e) {
      e.preventDefault();
      if (participantPad.isEmpty() && guardianPad.isEmpty()) {
        alert("Please provide at least one signature.");
        return;
      }
      alert("Waiver submitted. You can now print it.");
    });

    function printWaiver() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();

      const form = document.getElementById('waiverForm');
      const data = new FormData(form);
      let y = 10;

      doc.setFontSize(12);
      doc.text("Liability Waiver & Indemnity Agreement", 10, y);
      y += 10;

      for (let [key, value] of data.entries()) {
        doc.text(`${key.replace(/_/g, ' ')}: ${value}`, 10, y);
        y += 10;
      }

      if (!participantPad.isEmpty()) {
        const imgData = participantPad.toDataURL();
        doc.text("Participant Signature:", 10, y);
        y += 5;
        doc.addImage(imgData, 'PNG', 10, y, 60, 20);
        y += 25;
      }

      if (!guardianPad.isEmpty()) {
        const imgData = guardianPad.toDataURL();
        doc.text("Guardian Signature:", 10, y);
        y += 5;
        doc.addImage(imgData, 'PNG', 10, y, 60, 20);
        y += 25;
      }

      doc.save("waiver_form.pdf");
    }
  </script>
</body>
</html>
