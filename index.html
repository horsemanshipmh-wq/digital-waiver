
<!DOCTYPE html>
<html>
<head>
  <title>Digital Waiver Form</title>
  <script src="https://cdn.jsdelivr.net/npm/signature_pad@4.0.0/dist/signature_pad.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    canvas { border: 1px solid #000; width: 100%; height: 200px; }
    .form-section { margin-bottom: 20px; }
    label { display: block; margin-top: 10px; }
    input, select { width: 100%; padding: 8px; margin-top: 5px; }
    button { padding: 10px 20px; margin-top: 20px; }
  </style>
</head>
<body>
  <h2>Liability Waiver & Indemnity Agreement</h2>
  <p>IMPORTANT NOTICE:<br>
  Horse riding and related equestrian activities involve inherent risks. By signing this agreement, you acknowledge and accept these risks on behalf of yourself and/or your minor child. You also waive certain legal rights. Please read carefully.</p>

  <form id="waiverForm">
    <div class="form-section">
      <label>Participant Name</label>
      <input type="text" name="participantName" required>
      <label>Date of Birth</label>
      <input type="date" name="dob" required>
      <label>Parent/Guardian Name (if under 18)</label>
      <input type="text" name="guardianName">
      <label>Residential Address</label>
      <input type="text" name="address" required>
      <label>City</label>
      <input type="text" name="city" required>
      <label>State / Province</label>
      <input type="text" name="state" required>
      <label>Postal / Zip Code</label>
      <input type="text" name="zip" required>
      <label>Emergency Contact Name</label>
      <input type="text" name="emergencyName" required>
      <label>Emergency Contact Phone Number</label>
      <input type="tel" name="emergencyPhone" required>
      <label>Photo & Media Consent</label>
      <select name="mediaConsent" required>
        <option value="">--Please Select--</option>
        <option value="Yes">Yes</option>
        <option value="No">No</option>
      </select>
    </div>

    <div class="form-section">
      <label>Participant’s Signature (if older than 18)</label>
      <canvas id="participantSignature"></canvas>
      <button type="button" onclick="clearSignature(participantPad)">Clear Signature</button>
      <label>Date</label>
      <input type="date" name="participantDate">
    </div>

    <div class="form-section">
      <label>Parent/Guardian’s Signature (if under 18)</label>
      <canvas id="guardianSignature"></canvas>
      <button type="button" onclick="clearSignature(guardianPad)">Clear Signature</button>
      <label>Date</label>
      <input type="date" name="guardianDate">
    </div>

    <button type="submit">Submit & Download PDF</button>
  </form>

  <script>
    const participantPad = new SignaturePad(document.getElementById('participantSignature'));
    const guardianPad = new SignaturePad(document.getElementById('guardianSignature'));

    function clearSignature(pad) {
      pad.clear();
    }

    document.getElementById('waiverForm').addEventListener('submit', function(e) {
      e.preventDefault();

      const form = e.target;
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();

      let y = 10;
      doc.setFontSize(12);
      doc.text("Liability Waiver & Indemnity Agreement", 10, y); y += 10;

      const fields = [
        ["Participant Name", form.participantName.value],
        ["Date of Birth", form.dob.value],
        ["Parent/Guardian Name", form.guardianName.value],
        ["Residential Address", form.address.value],
        ["City", form.city.value],
        ["State / Province", form.state.value],
        ["Postal / Zip Code", form.zip.value],
        ["Emergency Contact Name", form.emergencyName.value],
        ["Emergency Contact Phone Number", form.emergencyPhone.value],
        ["Photo & Media Consent", form.mediaConsent.value],
        ["Participant Signature Date", form.participantDate.value],
        ["Guardian Signature Date", form.guardianDate.value]
      ];

      fields.forEach(([label, value]) => {
        doc.text(`${label}: ${value}`, 10, y);
        y += 10;
      });

      if (!participantPad.isEmpty()) {
        const imgData = participantPad.toDataURL();
        doc.text("Participant Signature:", 10, y); y += 5;
        doc.addImage(imgData, 'PNG', 10, y, 60, 30); y += 35;
      }

      if (!guardianPad.isEmpty()) {
        const imgData = guardianPad.toDataURL();
        doc.text("Guardian Signature:", 10, y); y += 5;
        doc.addImage(imgData, 'PNG', 10, y, 60, 30); y += 35;
      }

      doc.save("waiver_submission.pdf");
    });
  </script>
</body>
</html>
